<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Report template for Aged Payable Report -->
    <template id="aged_payable">
        <t t-call="web.html_container">
            <t t-call="web.external_layout">
                <t t-set="data_report_margin_top" t-value="12"/>
                <t t-set="data_report_header_spacing" t-value="9"/>
                <t t-set="data_report_dpi" t-value="110"/>
                <div class="page">
                    <!-- Report Title -->
                    <h3 class="text-center">
                        <b>
                            <span t-esc="report_name"/>
                        </b>
                    </h3>
                    <br/>

                    <!-- Filters -->
                    <table class="table table-borderless" style="font-size:14px;">
                        <tbody>
                            <tr style="background-color:#d6dbe1;">
                                <th>Date Range</th>
                                <th>Partner</th>
                            </tr>
                            <tr>
                                <td>
                                    <t t-if="filters['end_date']">
                                        <t t-out="filters['end_date']"/>
                                    </t>
                                </td>
                                <td>
                                    <t t-foreach="filters['partner']"
                                       t-as="selected_partner"
                                       t-key="partner_index">
                                        <t t-out="selected_partner['display_name']"/>,
                                    </t>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <br/>
                    <br/>

                    <!-- Aged Payable Data -->
                    <t t-if="move_lines">
                        <t t-foreach="move_lines" t-as="move_line" t-key="partner_index">
                            <table class="table table-borderless" style="font-size:13px;">
                                <tbody>
                                    <!-- Table Header -->
                                    <tr style="background-color:#d6dbe1;">
                                        <th style="width:10%"></th>
                                        <th style="width:10%"></th>
                                        <th style="width:10%">Invoice Date</th>
                                        <th style="width:10%">Amount Currency</th>
                                        <th style="width:10%">Code</th>
                                        <th style="width:10%">Account</th>
                                        <th style="width:10%">Expected Date</th>
                                        <!-- Last 7 columns with equal width -->
                                        <th style="width:5%">Currency</th>
                                        <th style="width:5%">At Date</th>
                                        <th style="width:5%">1-30</th>
                                        <th style="width:5%">31-60</th>
                                        <th style="width:5%">61-90</th>
                                        <th style="width:5%">91-120</th>
                                        <th style="width:5%">Older</th>
                                        <th style="width:5%">Total</th>
                                    </tr>

                                    <!-- Partner line -->
                                    <tr style="background-color:#f0f0f0;font-weight:bold;">
                                        <td colspan="7">
                                            <span t-esc="move_line"/>
                                        </td>
                                        <td/>
                                        <td>
                                            <t t-if="total[move_line]['diff0_sum']"
                                               t-esc="total[move_line]['currency_id']"/>
                                            <t t-if="total[move_line]['diff0_sum']"
                                               t-esc="total[move_line]['diff0_sum']"/>
                                        </td>
                                        <td>
                                            <t t-if="total[move_line]['diff1_sum']"
                                               t-esc="total[move_line]['currency_id']"/>
                                            <t t-if="total[move_line]['diff1_sum']"
                                               t-esc="total[move_line]['diff1_sum']"/>
                                        </td>
                                        <td>
                                            <t t-if="total[move_line]['diff2_sum']"
                                               t-esc="total[move_line]['currency_id']"/>
                                            <t t-if="total[move_line]['diff2_sum']"
                                               t-esc="total[move_line]['diff2_sum']"/>
                                        </td>
                                        <td>
                                            <t t-if="total[move_line]['diff3_sum']"
                                               t-esc="total[move_line]['currency_id']"/>
                                            <t t-if="total[move_line]['diff3_sum']"
                                               t-esc="total[move_line]['diff3_sum']"/>
                                        </td>
                                        <td>
                                            <t t-if="total[move_line]['diff4_sum']"
                                               t-esc="total[move_line]['currency_id']"/>
                                            <t t-if="total[move_line]['diff4_sum']"
                                               t-esc="total[move_line]['diff4_sum']"/>
                                        </td>
                                        <td>
                                            <t t-if="total[move_line]['diff5_sum']"
                                               t-esc="total[move_line]['currency_id']"/>
                                            <t t-if="total[move_line]['diff5_sum']"
                                               t-esc="total[move_line]['diff5_sum']"/>
                                        </td>
                                        <td>
                                            <t t-if="total[move_line]['credit_sum']"
                                               t-esc="total[move_line]['currency_id']"/>
                                            <t t-if="total[move_line]['credit_sum']"
                                               t-esc="total[move_line]['credit_sum']"/>
                                        </td>
                                    </tr>

                                    <!-- Detail lines -->
                                    <t t-foreach="data[move_line]" t-as="valuelist" t-key="valuelist_index">
                                        <tr>
                                            <td>
                                                <t t-esc="valuelist['move_name']"/>
                                            </td>
                                            <td>
                                                <t t-esc="valuelist['name']"/>
                                            </td>
                                            <td>
                                                <t t-esc="valuelist['date']"/>
                                            </td>
                                            <td>
                                                <t t-esc="valuelist['amount_currency']"/>
                                            </td>
                                            <td>
                                                <t t-esc="valuelist['account_code']"/>
                                            </td>
                                            <td>
                                                <t t-esc="valuelist['account_name']"/>
                                            </td>

                                            <td>
                                                <t t-if="valuelist['date_maturity']"
                                                   t-esc="valuelist['date_maturity']"/>
                                            </td>
                                            <td>
                                                <t t-esc="valuelist['currency_id'][1]"/>
                                            </td>
                                            <td>
                                                <t t-if="valuelist['diff0']"
                                                   t-esc="total[move_line]['currency_id']"/>
                                                <t t-if="valuelist['diff0']"
                                                   t-esc="valuelist['diff0']"/>
                                            </td>
                                            <td>
                                                <t t-if="valuelist['diff1']"
                                                   t-esc="total[move_line]['currency_id']"/>
                                                <t t-if="valuelist['diff1']"
                                                   t-esc="valuelist['diff1']"/>
                                            </td>
                                            <td>
                                                <t t-if="valuelist['diff2']"
                                                   t-esc="total[move_line]['currency_id']"/>
                                                <t t-if="valuelist['diff2']"
                                                   t-esc="valuelist['diff2']"/>
                                            </td>
                                            <td>
                                                <t t-if="valuelist['diff3']"
                                                   t-esc="total[move_line]['currency_id']"/>
                                                <t t-if="valuelist['diff3']"
                                                   t-esc="valuelist['diff3']"/>
                                            </td>
                                            <td>
                                                <t t-if="valuelist['diff4']"
                                                   t-esc="total[move_line]['currency_id']"/>
                                                <t t-if="valuelist['diff4']"
                                                   t-esc="valuelist['diff4']"/>
                                            </td>
                                            <td>
                                                <t t-if="valuelist['diff5']"
                                                   t-esc="total[move_line]['currency_id']"/>
                                                <t t-if="valuelist['diff5']"
                                                   t-esc="valuelist['diff5']"/>
                                            </td>
                                            <td/>
                                        </tr>
                                    </t>
                                </tbody>
                            </table>
                        </t>
                    </t>

                    <!-- Grand Total -->
                    <table class="table table-borderless">
                        <tbody>
                            <tr style="font-weight:bold;">
                                <td style="width:80%;">Total</td>
                                <td style="width:5%">
                                    <t t-out="grand_total.get('currency')"/>
                                    <t t-out="grand_total.get('diff0_sum')"/>
                                </td>
                                <td style="width:5%">
                                    <t t-out="grand_total.get('currency')"/>
                                    <t t-out="grand_total.get('diff1_sum')"/>
                                </td>
                                <td style="width:5%">
                                    <t t-out="grand_total.get('currency')"/>
                                    <t t-out="grand_total.get('diff2_sum')"/>
                                </td>
                                <td style="width:5%">
                                    <t t-out="grand_total.get('currency')"/>
                                    <t t-out="grand_total.get('diff3_sum')"/>
                                </td>
                                <td style="width:5%">
                                    <t t-out="grand_total.get('currency')"/>
                                    <t t-out="grand_total.get('diff4_sum')"/>
                                </td>
                                <td style="width:5%">
                                    <t t-out="grand_total.get('currency')"/>
                                    <t t-out="grand_total.get('diff5_sum')"/>
                                </td>
                                <td style="width:5%">
                                    <t t-out="grand_total.get('currency')"/>
                                    <t t-out="grand_total.get('total_credit')"/>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </t>
        </t>
    </template>
</odoo>
